{% extends "base.html" %}
{% load static %}

{% block content %}

<style>
  /* ================== Hero Section ================== */
  .section-intro{
    background: linear-gradient(180deg, #f8fafc, #ffffff);
  }
  .intro-banner-wrap img{
    width:100%;
    height:auto;
    border-radius:1rem;
  }

  /* ================== Section Headings ================== */
  .section-heading{ margin-bottom:1rem; }
  .section-heading .section-title{ font-weight:700; letter-spacing:.2px; }
  .section-heading .btn{ border-radius:.6rem; }

  /* ================== Product Cards ================== */
  .card-product-grid{
    border:1px solid #eef1f5;
    border-radius:1rem;
    overflow:hidden;
    background:#fff;
    display:flex; flex-direction:column; height:100%;
    transition:transform .18s ease, box-shadow .18s ease;
  }
  .card-product-grid:hover{ transform:translateY(-3px); box-shadow:0 10px 26px rgba(23,43,77,.08); }

  /* image square */
  .card-product-grid .img-wrap{
    position:relative; display:block; overflow:hidden; background:#f3f5f9; margin-bottom:0;
  }
  .card-product-grid .img-wrap::before{ content:""; display:block; padding-top:100%; }
  .card-product-grid .img-wrap img{
    position:absolute; inset:0; width:100%; height:100%; object-fit:cover; transition:transform .25s ease;
  }
  .card-product-grid:hover .img-wrap img{ transform:scale(1.05); }

  /* info area */
  .info-wrap{
    padding:.7rem 1rem 1rem;
    flex-grow:1; display:flex; flex-direction:column; justify-content:space-between;
  }
  .card-product-grid .title{
    display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;
    color:#0f172a; font-weight:600; text-decoration:none;
    margin:0 0 .35rem 0; min-height:2.8rem;
  }
  .card-product-grid .title:hover{ text-decoration:underline; }
  .card-product-grid .price{ font-weight:700; color:#0ea5e9; font-size:1.05rem; margin-bottom:.7rem; }

  /* ================== Actions ================== */
  .product-actions{ display:flex; gap:.4rem; flex-wrap:nowrap; margin-top:auto; }

  /* View Details */
  .btn-view{
    flex:1; text-align:center; padding:.5rem 0; font-size:.9rem; font-weight:600; border-radius:.5rem;
    background:#f3f4f6 !important; color:#0f172a !important; border:1px solid #e2e8f0 !important;
    text-decoration:none; transition:all .2s ease;
  }
  .btn-view:hover{ background:#e2e8f0 !important; }

  /* ===== Buy Now â€” hard overrides against any theme/Bootstrap ===== */
  /* base state */
  a.btn-buy, a.btn.btn-buy, .card .product-actions a.btn-buy{
    display:inline-block; flex:1; text-align:center; padding:.5rem 0; font-size:.9rem; font-weight:600; border-radius:.5rem;
    background:#0ea5e9 !important; color:#ffffff !important; border:none !important; box-shadow:none !important;
    text-decoration:none !important; appearance:none;
  }
  /* interactive states */
  a.btn-buy:hover, a.btn.btn-buy:hover,
  a.btn-buy:focus, a.btn.btn-buy:focus,
  a.btn-buy:active, a.btn.btn-buy:active{
    background:#0284c7 !important; color:#ffffff !important; text-decoration:none !important;
    transform:translateY(-2px); outline:none !important;
  }
  /* visited links: only color is allowed by browsers, so force it white */
  a.btn-buy:visited{ color:#ffffff !important; }

  /* ================== Stock Out Styles ================== */
  .stock-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(239, 68, 68, 0.95);
    color: #ffffff;
    padding: 0.4rem 0.8rem;
    border-radius: 0.5rem;
    font-weight: 700;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    z-index: 10;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
  }
  
  .card-product-grid.out-of-stock {
    opacity: 0.75;
  }
  
  .card-product-grid.out-of-stock:hover {
    transform: none;
    box-shadow: 0 2px 8px rgba(23, 43, 77, 0.05);
  }
  
  .card-product-grid.out-of-stock .img-wrap img {
    filter: grayscale(30%);
  }
  
  .btn-disabled {
    background: #e5e7eb !important;
    color: #9ca3af !important;
    cursor: not-allowed !important;
    pointer-events: none;
    flex: 1;
    text-align: center;
    padding: 0.5rem 0;
    font-size: 0.9rem;
    font-weight: 600;
    border-radius: 0.5rem;
    border: 1px solid #d1d5db !important;
    text-decoration: none !important;
  }

  @media (max-width:575.98px){
    .section-intro{ padding-top:.75rem; }
  }
</style>

<!-- ========================= SECTION MAIN ========================= -->
<section class="section-intro padding-y-sm">
  <div class="container">
    <div class="intro-banner-wrap">
      <img src="{% static 'images/banners/1.jpg' %}" class="img-fluid" alt="Featured banner">
    </div>
  </div>
</section>
<!-- ========================= SECTION MAIN END// ========================= -->

<!-- ========================= SECTION ========================= -->
<section class="section-name padding-y-sm">
  <div class="container">

    <header class="section-heading d-flex align-items-center justify-content-between">
      <h3 class="section-title mb-0">Popular products</h3>
      <a href="{% url 'store' %}" class="btn btn-outline-primary btn-sm">See all</a>
    </header>

    <div class="row g-3 g-md-4">
      {% for product in products %}
      <div class="col-6 col-md-4 col-lg-3 d-flex">
        <div class="card card-product-grid w-100 {% if product.stock <= 0 %}out-of-stock{% endif %}">
          <a href="{{ product.get_url }}" class="img-wrap" aria-label="{{ product.product_name }}">
            {% if product.stock <= 0 %}
              <span class="stock-badge">Stock Out</span>
            {% endif %}
            <img src="{{ product.images.url }}" alt="{{ product.product_name }}" loading="lazy" width="600" height="600">
          </a>

          <figcaption class="info-wrap">
            <div>
              <a href="{{ product.get_url }}" class="title">{{ product.product_name }}</a>
              <div class="price">Tk. {{ product.price }}</div>
            </div>

            <div class="product-actions">
              {% if product.stock <= 0 %}
                <span class="btn-view btn-disabled">Out of Stock</span>
                <span class="btn-disabled">Unavailable</span>
              {% else %}
                {% if product.requires_variation %}
                  <a href="{{ product.get_url }}" class="btn-view">Choose Options</a>
                {% else %}
                  <a href="{{ product.get_url }}" class="btn-view">View Details</a>
                {% endif %}
                <a href="{% url 'buy_now' product.id %}" class="btn btn-primary">Buy Now</a>
              {% endif %}
            </div>

          </figcaption>
        </div>
      </div>
      {% endfor %}
    </div>

  </div><!-- container // -->
</section>
<!-- ========================= SECTION END// ========================= -->

{% endblock %}